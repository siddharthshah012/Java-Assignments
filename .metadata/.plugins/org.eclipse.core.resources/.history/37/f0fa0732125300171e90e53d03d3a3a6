package com.gcit.LibrarySystem.test;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
//import java.util.List;
import java.util.Scanner;

public class LibraryManagement {
	
	Scanner scanner  = new Scanner(System.in);
	
	public void mainDisplay(){
		
		int i = 0;
		
		System.out.println("Welcome to the GCIT Library Management System. Which category of a user are you");
		System.out.println("1) Librarian");
		System.out.println("2) Administrator");
		System.out.println("3) Borrower");
		System.out.println("4) Quit");
		
		
		i = scanner.nextInt();
		
		switch (i){
			
		case(1):libDisplay1();
				break;
			
		case(2):adminDisplay();
				break;
			
		case(3):borrowerDisplay();
				break;
				
		case(4):return;
		
		}
	}
	
	public void adminDisplay(){
		
		System.out.println("Admin");
	}
	public String libDisplay1(){
		int i=0; 
		System.out.println("Lib");
		System.out.println("Enter the Branch you Manage");
		System.out.println("Quit to previous menu");
		i = scanner.nextInt();
		
		switch(i){
		
		case(1):libDisplay2();
				break;
		case(2):mainDisplay();
				break;
		}
		return null;
	}
	
	
	public void libDisplay2() {
		
		//JDBCConnect jdbcconnect = new JDBCConnect();
		
		Connection conn =JDBCConnect.getConnection();
		ArrayList<Integer> listBranchId = new ArrayList<Integer>();
		ArrayList<String> listBranchNames = new ArrayList<String>();
		ArrayList<String> listBranchAddress = new ArrayList<String>();
		
		String inputInArrayList ="";
		String query = "";
		
		Statement stmt;
		try {
			
			stmt = conn.createStatement();
			query = "select * from tbl_library_branch order by branchId DESC ";
			ResultSet rs = stmt.executeQuery(query);
			while(rs.next()){
				
				listBranchId.add(rs.getInt("branchId"));
				listBranchNames.add(rs.getInt("branchId")+","+rs.getString("branchName")+","+ rs.getString("branchAddress"));
				
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally{
			
			if(conn!=null){
				try {
					conn.close();
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		}
		
		//listBranchNames.forEach(s -> System.out.println(s));
		for (int i = 0; i < listBranchNames.size(); i++) {
			
			String[] splitStr = listBranchNames.get(i).split(",");
			System.out.print((i+1)+") ");
			System.out.print(splitStr[1]+",");
			System.out.println(splitStr[2]);
		}
		System.out.println((listBranchNames.size()+1)+") Quit to Previous Menu");
		
		System.out.println("Enter the number ");
		int selectedNumber=0;
		selectedNumber = scanner.nextInt();
		
		if (selectedNumber == (listBranchNames.size()+1)){
			libDisplay1();
		}
		else{
			if (selectedNumber >=0 && selectedNumber <= listBranchNames.size()){
				
				for (int i = 0; i < listBranchNames.size(); i++) {
					//System.out.print(i+" ");
					if (selectedNumber == (i+1)){
						libDisplay3(listBranchNames.get(i));
					}	
				}
			}
			else{
				System.out.println("Please enter a suitable number");
				libDisplay2();
			}
			
		}
		
	}
	
	
	public void libDisplay3(String s){
		
		
		String[] splitStr = s.split(",");
		
		System.out.println("Please enter the suitable number acc to your selection");
		System.out.println("1)	Update the details of the Library");
		System.out.println("2)	Add copies of Book to the Branch");
		System.out.println("3)	Quit to previous");
		int i=0;
		i = scanner.nextInt();
		
		String newBranchName;
		String newBranchAddress;
		switch(i){
		case(1):System.out.println("You have chosen to update the Branch with Branch Id: "+splitStr[0]+" and Branch Name: "+splitStr[1]);
				
				System.out.println("Please enter new branch name or enter N/A for no change:");
				newBranchName = scanner.next();
				
				System.out.println("Please enter new branch address or enter N/A for no change:");
				newBranchAddress = scanner.next();
				
				
				
				
		case(2):break;
		case(3):break;
		default:
		}
		
		
		//System.out.println(s);
		
	}
	
	public void borrowerDisplay(){
		System.out.println("borrower");
		
	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		LibraryManagement lm = new LibraryManagement();
		lm.mainDisplay();
		
		

	}

}
